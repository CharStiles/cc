<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.1/p5.js"></script>

    <meta charset="utf-8" />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      html, body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }
      
      body {
        display: block;
      }
      
      canvas {
        display: block;
      }
    </style>
  </head>
  <body>
    <main>
    </main>
    <script>
    
    
let video;

let program, shadertime;

var isClicked



function mouseClicked(){
  isClicked = !isClicked;
  shaderTime =0;
}

var vert = `

#ifdef GL_ES
      precision highp float;
      precision highp int;
    #endif

    // attributes, in
    attribute vec3 aPosition;
    attribute vec3 aNormal;
    attribute vec2 aTexCoord;
    attribute vec4 aVertexColor;


    // attributes, out
    varying vec3 var_vertPos;
    varying vec4 var_vertCol;
    varying vec3 var_vertNormal;
    varying vec2 var_vertTexCoord;
    varying vec2 vUv;

    // matrices
    uniform mat4 uModelViewMatrix;
    uniform mat4 uProjectionMatrix;
    //uniform mat3 uNormalMatrix;

    void main() {
      gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(aPosition, 1.0);
      // Use texture coordinates if available, otherwise calculate from position
      vUv = aTexCoord;
    

      // var_vertPos      = aPosition;
      // var_vertCol      = aVertexColor;
      // var_vertNormal   = aNormal;
      // var_vertTexCoord = aTexCoord;

    }
    // Vertex shader
precision mediump float;



`;

//YOUR CODE GOES HERE IN BETWEEN THE tick MARKS
var frag = `
// Fragment shader
precision mediump float;

uniform vec2 u_resolution;
uniform float u_time;
uniform int u_numBubbles;

varying vec2 vUv;


float hash(vec2 p) {
  return fract(sin(dot(p, vec2(127.1, 311.7))) * 129412.43);
}

void main() {
  vec2 uv = vUv;
  vec3 color = vec3(0.0);

  vec3 bubbleColor = vec3(0.5, 0.9, 1.0);

  for (int i = 0; i < 20; i++) {
    if (i >= u_numBubbles) break;
    float fi = float(i);

    float s = hash(vec2(fi, 0.0));
    float x = mix(0.08, 0.92, hash(vec2(fi, 1.0))); 
    float y0 = mix(0.15, 0.85, hash(vec2(fi, 2.0))); 
    float v = 0.2 + fract(s * 7.3) * 0.25;          

    float cy = fract(y0 + u_time * v);

    float drift = 0.25 * sin(u_time * (0.4 + fi * 0.1));
    float cx = fract(x + drift);

    vec2 center = vec2(cx, cy);

    float r = 0.02 + 0.02 * hash(vec2(fi, 3.0));

    float d = distance(uv, center);

    float sigma = r * 0.65;
    float brightness = exp(- (d * d) / (2.0 * sigma * sigma));

    color += bubbleColor * brightness;
  }

  color = clamp(color, 0.0, 1.0);
  gl_FragColor = vec4(color, 1.0);
}
`;

function setup() {
  createCanvas(windowWidth, windowHeight, WEBGL);
  noStroke();

  theShader = createShader(vert, frag);
  shader(theShader);
}

function draw() {
  background(0);
  noCursor();
  background(255,255)

  theShader.setUniform('u_time', millis() / 1000.0);
  theShader.setUniform('u_resolution', [width, height]);
  theShader.setUniform('u_numBubbles', 30); 

  translate(-width/2, -height/2);
  plane(width*2, height*2);
}



    </script>
  </body>
</html>
